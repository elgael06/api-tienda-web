{"ast":null,"code":"import sqlite from 'sqlite';\nconst dirDB = './database.sqlite';\nexport const select = async () => ({\n  db: await sqlite.open(dirDB),\n\n  //empresa\n  async allEmpresar() {\n    try {\n      const empresas = (await this.db.all('SELECT * FROM Empresa').catch(() => [])) || [];\n      console.log(\"Empresas =>\", JSON.stringify(empresas, null, 2));\n      this.db.close();\n      return {\n        error: false,\n        data: empresas\n      };\n    } catch (e) {\n      return {\n        error: true,\n        message: e.toString()\n      };\n    }\n  },\n\n  async idEmpresa(id) {\n    const empresa = await this.db.get('SELECT * FROM Empresa where id=?', [id]);\n    this.db.close();\n    return empresa || null;\n  },\n\n  //usuario\n  async allUsuario() {\n    try {\n      const usuarios = (await this.db.all('SELECT * FROM Usuarios').catch(() => [])) || [];\n      console.log(`usuarios => `, JSON.stringify(usuarios, null, 2));\n      this.db.close();\n      return {\n        error: false,\n        data: usuarios\n      };\n    } catch (e) {\n      return {\n        error: true,\n        message: e.toString()\n      };\n    }\n  }\n\n});\nexport const insert = async () => ({\n  db: await sqlite.open(dirDB),\n\n  async existTable() {\n    await this.db.run(`CREATE TABLE IF NOT EXISTS  Empresa (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            nombre TEXT,\n            telefono TEXT,\n            direccion TEXT\n        )`);\n    await this.db.run(`CREATE TABLE IF NOT EXISTS  Usuarios (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            nombre TEXT,\n            apPaterno TEXT,\n            apMaterno TEXT,    \n            puesto int        \n        )`);\n    this.db.close();\n  },\n\n  async newEmpresa(nombre, telefono, direccion) {\n    this.existTable();\n    const res = await this.db.run('INSERT INTO Empresa (nombre, telefono, direccion) values(?,?,?)', [nombre, telefono, direccion]);\n    this.db.close();\n    console.log('listo', res);\n    return res;\n  },\n\n  async newUsuario(nombre, apPaterno, apMaterno, puesto) {\n    this.existTable();\n    const res = await this.db.run('INSERT INTO Usuarios (nombre, apPaterno, apMaterno, apMaterno, puesto) values(????)', [nombre, apMaterno, apPaterno, puesto]);\n    this.db.close();\n    console.log('listo', res);\n    return res;\n  }\n\n});","map":{"version":3,"sources":["/home/gael/development/web/backend/nextJS/api-tienda-web/database/index.ts"],"names":["sqlite","dirDB","select","db","open","allEmpresar","empresas","all","catch","console","log","JSON","stringify","close","error","data","e","message","toString","idEmpresa","id","empresa","get","allUsuario","usuarios","insert","existTable","run","newEmpresa","nombre","telefono","direccion","res","newUsuario","apPaterno","apMaterno","puesto"],"mappings":"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","sourcesContent":["import sqlite  from 'sqlite';\n\nconst dirDB = './database.sqlite';\n\nexport const select = async ()=>({\n    db : await sqlite.open(dirDB),\n    //empresa\n    async allEmpresar(){\n        try{\n            const empresas = await this.db.all('SELECT * FROM Empresa')\n                .catch(()=>[]) || [];\n            console.log(\"Empresas =>\", JSON.stringify(empresas,null,2));\n            this.db.close();\n            return {error:false,data:empresas};\n        }catch(e){\n            return {error:true,message:e.toString()};\n        }\n    },\n    async idEmpresa(id:number){\n        const empresa =  await this.db.get('SELECT * FROM Empresa where id=?',[id]);\n        this.db.close();\n        return empresa || null;\n    },\n    //usuario\n    async allUsuario(){\n        try{\n            const usuarios = await this.db.all('SELECT * FROM Usuarios')\n                .catch(()=>[]) || [];\n            console.log(`usuarios => `, JSON.stringify(usuarios,null,2));\n            this.db.close();\n            return {error:false,data:usuarios};\n\n        }catch(e){\n            return {error:true,message:e.toString()};\n        }\n    }\n\n});\n\nexport const insert = async () => ({\n    db : await sqlite.open(dirDB),\n    async existTable(){\n        await this.db.run(`CREATE TABLE IF NOT EXISTS  Empresa (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            nombre TEXT,\n            telefono TEXT,\n            direccion TEXT\n        )`);\n        await this.db.run(`CREATE TABLE IF NOT EXISTS  Usuarios (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            nombre TEXT,\n            apPaterno TEXT,\n            apMaterno TEXT,    \n            puesto int        \n        )`);\n        this.db.close();\n    },\n    async newEmpresa(\n        nombre      : String,\n        telefono    : String,\n        direccion   : String\n    ){\n        this.existTable();\n        const res = await this.db.run('INSERT INTO Empresa (nombre, telefono, direccion) values(?,?,?)',[nombre, telefono, direccion]);\n        this.db.close();\n        console.log('listo',res);\n        return res;\n    },\n    async newUsuario(\n        nombre:String,\n        apPaterno: String,\n        apMaterno: String,\n        puesto:Int16Array\n    ){\n\n        this.existTable();\n        const res = await this.db.run('INSERT INTO Usuarios (nombre, apPaterno, apMaterno, apMaterno, puesto) values(????)',\n            [nombre,apMaterno,apPaterno,puesto]);\n        this.db.close();\n        console.log('listo',res);\n        return res;\n    }\n});\n\n"]},"metadata":{},"sourceType":"module"}